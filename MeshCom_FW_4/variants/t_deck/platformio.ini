[env:t_deck]
extends = esp32
board = T-Deck
;platform = espressif32 @ 6.6.0 ;https://github.com/Bodmer/TFT_eSPI/issues/3332
upload_command = pio pkg exec -p "tool-esptoolpy" -- esptool -b 921600 write_flash 0x0000 ${platformio.build_dir}/${this.__env__}/bootloader.bin 0xE000 otadata.bin 0x8000 ${platformio.build_dir}/${this.__env__}/partitions.bin 0x10000 safeboot-s3.bin 0xC0000 ${platformio.build_dir}/${this.__env__}/firmware.bin
board_build.partitions = partitions-16MB-safeboot.csv

lib_ignore = Adafruit TCA8418, epdiy, es7210, GxEPD2, TinyGSM

build_src_filter = 
	${esp32.src_filter}
	+<t-deck/*>
	-<t-deck-pro/*>
	-<t5-epaper/*>
	-<U8g2/*>

lib_deps =
	${libs.lib_deps}
	${esp32libs.lib_deps}
	bxparks/AceButton @ ^1.10.1
	https://github.com/schreibfaul1/ESP32-audioI2S
	;schreibfaul1/ESP32-audioI2S @^3.4.47
	lewisxhe/SensorLib@^0.2.6

build_flags = 
	${esp32.build_flags}
	${common.build_flags}
    -DBOARD_HAS_PSRAM=1
    -DCORE_DEBUG_LEVEL=1
    -DARDUINO_USB_CDC_ON_BOOT=1  ; Enable UARDUINO_USB_CDC_ON_BOOT will start printing and wait for terminal access during startup
    ; -UARDUINO_USB_CDC_ON_BOOT  ; Enable UARDUINO_USB_CDC_ON_BOOT will turn off printing and will not block when using the battery
	-D LV_CONF_INCLUDE_SIMPLE
	-D BOARD_T_DECK="tdeck"
    -D DISABLE_ALL_LIBRARY_WARNINGS=1	
	-I variants/${this.__env__}